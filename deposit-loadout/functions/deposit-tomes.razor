
sysmsg "deposit tomes - start"
#@setvar! _this_script "Play Script: deposit-loadout\functions\deposit-tomes"

## TO ADD: carpet rack, cards

@setvar! _disable_mastery_link_tome 1
    
@setvar!  _tome_use_context_menu 1
@setvar!  _tome_cont_ext_menu_wait 200


@settimer!  _this_run 0

@removelist!  _tome_list
@createlist!  _tome_list
@removelist!  _tome_gumps
@createlist!  _tome_gumps



#### tome serials
## mastery chain tome
@pushlist!  _tome_list  _deposit_loadout__tomes__mastery_chain
## rare cloth tome
@pushlist!  _tome_list  _deposit_loadout__tomes__cloth
## aspect tome
@pushlist!  _tome_list  _deposit_loadout__tomes__aspect
## skill scrolls skill mastery tome
@pushlist!  _tome_list  _deposit_loadout__tomes__skill_scrolls 
## dyes tome
@pushlist!  _tome_list  _deposit_loadout__tomes__dyes 
## carpet rack
@pushlist!  _tome_list  _deposit_loadout__menuable__carpet_rack

#### maps
## ore tome
@pushlist!  _tome_list  _deposit_loadout__tomes__maps__ore
## fishing tome
@pushlist!  _tome_list  _deposit_loadout__tomes__maps__fishing
## skinning tome
@pushlist!  _tome_list  _deposit_loadout__tomes__maps__skinning
## treasure tome
@pushlist!  _tome_list  _deposit_loadout__tomes__maps__treasure
## lumber tome
@pushlist!  _tome_list  _deposit_loadout__tomes__maps__lumber




#### tome gumps - needs to match the same order as _tome_list
## mastery chain gump
@pushlist!  _tome_gumps  _common_gumps__tome__mastery_chain
## cloth tome
@pushlist!  _tome_gumps  _common_gumps__tome__cloth
## aspect tome
@pushlist!  _tome_gumps  _common_gumps__tome__aspect
## skill scrolls skill mastery tome
@pushlist!  _tome_gumps  _common_gumps__tome__skill_scroll
## dyes tome
@pushlist!  _tome_gumps  _common_gumps__tome__dye
## carpet rack
@pushlist!  _tome_gumps  _common_gumps__tome__carpet

#### maps
## ore tome
@pushlist!  _tome_gumps  _common_gumps__maps__ore
## fishing tome
@pushlist!  _tome_gumps  _common_gumps__maps__fishing
## skinning tome
@pushlist!  _tome_gumps  _common_gumps__maps__skinning
## treasure tome
@pushlist!  _tome_gumps  _common_gumps__maps__treasure
## lumber tome
@pushlist!  _tome_gumps  _common_gumps__maps__lumber




if _disable_mastery_link_tome == 1
    poplist _tome_list front
    poplist _tome_gumps front
endif

if _tome_use_context_menu == 1
    foreach _a_tome in _tome_list
        if _a_time != 0
            menu _a_tome 0
            #wait _tome_context_menu_wait
            @getlabel! _a_tome _tmp_label
        endif
    endfor
else
    foreach _a_tome in _tome_list
        if _a_time != 0
            dclick _a_tome
            if poplist _tome_gumps front as _a_tome_gump
                waitforgump _a_tome_gump
                gumpresponse 2 _a_tome_gump
                waitforgump _a_tome_gump
                gumpclose _a_tome_gump
            endif
        endif
    endfor
endif


while queued
endwhile

#wait 600
sysmsg "deposit tomes - complete, time {{_this_run}}"




#### continue script chain
if listexists _script_chain and list _script_chain > 0
    poplist _script_chain front
    foreach _a_script in _script_chain
        hotkey _a_script
    endfor
endif